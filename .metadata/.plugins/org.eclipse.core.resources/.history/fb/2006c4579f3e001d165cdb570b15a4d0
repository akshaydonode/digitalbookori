package com.cts.digitalbook.digitalbookauthorservice.controllers;

import static org.mockito.Mockito.when;

import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.springframework.boot.test.context.SpringBootTest;

import com.cts.digitalbook.digitalbookauthorservice.dtos.ResponseDTO;
import com.cts.digitalbook.digitalbookauthorservice.entities.AuthorEntity;
import com.cts.digitalbook.digitalbookauthorservice.exceptions.DigitalBookException;
import com.cts.digitalbook.digitalbookauthorservice.services.AuthorService;

@SpringBootTest
public class AuthorControllerTest {

	@InjectMocks
	AuthorController authorController;

	@Mock
	AuthorService authorService;

	@Test
	public void registerTest() throws DigitalBookException {
		AuthorEntity authorEntity = new AuthorEntity();
		authorEntity.setAuthorEmail("akshay@mail.com");
		authorEntity.setAuthorId(1);
		authorEntity.setAuthorName("digitalbook");
		authorEntity.setPassword("QAWSED");

		ResponseDTO responseDto = new ResponseDTO();
		responseDto.setMessage("Author Registered Successfully...");
		responseDto.setResult(responseDto);

		when(authorService.registerAuthorService(authorEntity)).thenReturn(authorEntity);

		authorController.registerAuthor(authorEntity);
	}

	@Test
	public void registerTestWithException() throws DigitalBookException {
		AuthorEntity authorEntity = new AuthorEntity();
		authorEntity.setAuthorEmail(null);

		when(authorService.registerAuthorService(authorEntity)).thenThrow(new DigitalBookException(
				"Author Registration Failed. PLease fill all the fileds like Name, EmailID, Password. Thank You !!!"));
		
		authorController.registerAuthor(authorEntity);

	}

}
